
# URLSession
### ì°¸ì—¬ì
 - vetto
 - harry
 - ë¦¬ì§€
 - ì†¡ì¤€

### ì§„í–‰ì
- ì†¡ì¤€

### ì§„í–‰ì¼ì‹œ
- 2023.03.25
 

### ğŸ‘¨â€ğŸ”¬ ì‹¤í—˜ ëª©í‘œ
- Postmanì„ í™œìš©í•´ì„œ APIë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.
- ì½”ë“œë¥¼ í†µí•´ ë„¤íŠ¸ì›Œí‚¹ì„ í•  ìˆ˜ ìˆë‹¤.

# ğŸ‘¨â€ğŸ”¬ ì‹¤í—˜ 1: Postman í™œìš©í•´ GET ì§„í–‰í•´ë³´ê¸°
### GET
![image](https://user-images.githubusercontent.com/88870642/227689323-2124adf7-7c8b-4ee4-81c4-3b402807f586.png)

### POST
- URL
![image](https://user-images.githubusercontent.com/88870642/227689621-e055423b-878e-4fa5-87e4-a95407b1d17c.png)


- Head
Header ì—ì„œ identifier ì¶”ê°€

![image](https://user-images.githubusercontent.com/88870642/227689363-611186c6-99c0-4e07-aecf-35ae447c6e5a.png)

- Body
Body ì—ì„œ íƒ€ì…ì„ ì§€ì •í•˜ê³  (form-data) í•„ìˆ˜ ê°’ ì…ë ¥

![image](https://user-images.githubusercontent.com/88870642/227689385-33f2917c-7728-49c9-b805-3700152c81de.png)

![](https://i.imgur.com/JmgIykx.png)

postmanì„ ì‚¬ìš©ì‹œì—ëŠ” requiredë§Œ ì ì–´ì£¼ê²Œ ë˜ë©´ ìë™ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì¤€ë‹¤.

# ğŸ‘¨â€ğŸ”¬ ì‹¤í—˜ 2: Xcode í™œìš©í•´ GET, POST í•´ë³´ê¸°

- ê³µí†µì ìœ¼ë¡œ image íŒŒì¼ ì „ì†¡ ì‹¤íŒ¨ ë¬¸ì œë¥¼ ê²ªì—ˆë‹¤...ğŸ¥²

```swift
func post() {
        let parameters = [
          [
            "key": "params",
            "value": "{ \"name\": \"ttt\", \"description\": \"t1t1t1\", \"price\": 10000, \"currency\":  \"KRW\", \"discounted_price\":  500, \"stock\":  1234567, \"secret\": \"soobak1234\" }",
            "type": "text",
            "contentType": "application/json"
          ],
          [
            "key": "images",
            "src": "image.png",
            "type": "file"
          ]] as [[String : Any]]
        
        let boundary = "Boundary-\(UUID().uuidString)"
        var body = ""
        var error: Error? = nil
        
        for param in parameters {
          if param["disabled"] == nil {
            let paramName = param["key"]!
            body += "--\(boundary)\r\n"
            body += "Content-Disposition:form-data; name=\"\(paramName)\""
            if param["contentType"] != nil {
              body += "\r\nContent-Type: \(param["contentType"] as! String)"
            }
            let paramType = param["type"] as! String
            if paramType == "text" {
              let paramValue = param["value"] as! String
              body += "\r\n\r\n\(paramValue)\r\n"
            } else {
                let fileData = try! NSData(contentsOfFile: URL(fileURLWithPath: "https://user-images.githubusercontent.com/88870642/227688946-e50847f4-723a-4ae3-badf-6cdbfebd7268.png")) // ì´ë¶€ë¶„ì´ í•´ê²°ì´ ì•ˆë¨
              let fileContent = String(data: fileData, encoding: .utf8)!
              body += "; filename=\"imagep\"\r\n"
                + "Content-Type: \"content-type header\"\r\n\r\n\(fileContent)\r\n"
            }
          }
        }
        body += "--\(boundary)--\r\n";
        let postData = body.data(using: .utf8)

        var request = URLRequest(url: URL(string: "https://{{host}}/api/products")!,timeoutInterval: Double.infinity)
        request.addValue("c5b13912-43b9-11ed-8b9b-0956155ef06a", forHTTPHeaderField: "identifier")
        request.addValue("multipart/form-data; boundary=\(boundary)", forHTTPHeaderField: "Content-Type")

        request.httpMethod = "POST"
        request.httpBody = postData

        let task = URLSession.shared.dataTask(with: request) { data, response, error in
          guard let data = data else {
            print(String(describing: error))
            return
          }
          print(String(data: data, encoding: .utf8)!)
        }

        task.resume()
    }
}

```
